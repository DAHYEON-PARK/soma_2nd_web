<!DOCTYPE html>
<!--[if IE 9 ]><html class="ie9"><![endif]-->
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Admin</title>

	<!-- Vendor CSS -->
	<link href="vendors/bower_components/animate.css/animate.min.css" rel="stylesheet">
	<link href="vendors/bower_components/bootstrap-sweetalert/lib/sweet-alert.css" rel="stylesheet">
	<link href="vendors/bower_components/material-design-iconic-font/dist/css/material-design-iconic-font.min.css" rel="stylesheet">
		
	<!-- CSS -->
	<link href="css/app.min.1.css" rel="stylesheet">
	<link href="css/app.min.2.css" rel="stylesheet">

	<!-- Javascript Libraries -->
	<script src="vendors/bower_components/jquery/dist/jquery.min.js"></script>
	<script src="vendors/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
	<script src="vendors/bower_components/Waves/dist/waves.min.js"></script>
	<script src="vendors/bootstrap-growl/bootstrap-growl.min.js"></script>
	<script src="vendors/bower_components/bootstrap-sweetalert/lib/sweet-alert.min.js"></script>

	<script src="js/functions.js"></script>
	<script src="js/demo.js"></script>
	<script src="js/crud.js"></script>

</head>
<body>
	<header id="header">
		<ul class="header-inner">
			<li id="menu-trigger" data-trigger="#sidebar">
				<div class="line-wrap">
					<div class="line top"></div>
					<div class="line center"></div>
					<div class="line bottom"></div>
				</div>
			</li>
		
			<li class="logo hidden-xs">
				<a href="index.html">Admin</a>
			</li>
			
			<li class="pull-right">
			<ul class="top-menu">
				<li id="toggle-width">
					<div class="toggle-switch">
						<input id="tw-switch" type="checkbox" hidden="hidden">
						<label for="tw-switch" class="ts-helper"></label>
					</div>
				</li>
				<li id="top-search">
					<a class="tm-search" href=""></a>
				</li>
				<li class="dropdown">
					<a data-toggle="dropdown" class="tm-message" href=""><i class="tmn-counts">6</i></a>
					<div class="dropdown-menu dropdown-menu-lg pull-right">
						<div class="listview">
							<div class="lv-header">
								Messages
							</div>
							<div class="lv-body">
								<a class="lv-item" href="">
									<div class="media">
										<div class="pull-left">
											<img class="lv-img-sm" src="img/profile-pics/1.jpg" alt="">
										</div>
										<div class="media-body">
											<div class="lv-title">David Belle</div>
											<small class="lv-small">Cum sociis natoque penatibus et magnis dis parturient montes</small>
										</div>
									</div>
								</a>
								<a class="lv-item" href="">
									<div class="media">
										<div class="pull-left">
											<img class="lv-img-sm" src="img/profile-pics/2.jpg" alt="">
										</div>
										<div class="media-body">
											<div class="lv-title">Jonathan Morris</div>
											<small class="lv-small">Nunc quis diam diamurabitur at dolor elementum, dictum turpis vel</small>
										</div>
									</div>
								</a>
								<a class="lv-item" href="">
									<div class="media">
										<div class="pull-left">
											<img class="lv-img-sm" src="img/profile-pics/3.jpg" alt="">
										</div>
										<div class="media-body">
											<div class="lv-title">Fredric Mitchell Jr.</div>
											<small class="lv-small">Phasellus a ante et est ornare accumsan at vel magnauis blandit turpis at augue ultricies</small>
										</div>
									</div>
								</a>
								<a class="lv-item" href="">
									<div class="media">
										<div class="pull-left">
											<img class="lv-img-sm" src="img/profile-pics/4.jpg" alt="">
										</div>
										<div class="media-body">
											<div class="lv-title">Glenn Jecobs</div>
											<small class="lv-small">Ut vitae lacus sem ellentesque maximus, nunc sit amet varius dignissim, dui est consectetur neque</small>
										</div>
									</div>
								</a>
								<a class="lv-item" href="">
									<div class="media">
										<div class="pull-left">
											<img class="lv-img-sm" src="img/profile-pics/4.jpg" alt="">
										</div>
										<div class="media-body">
											<div class="lv-title">Bill Phillips</div>
											<small class="lv-small">Proin laoreet commodo eros id faucibus. Donec ligula quam, imperdiet vel ante placerat</small>
										</div>
									</div>
								</a>
							</div>
							<a class="lv-footer" href="">View All</a>
						</div>
					</div>
				</li>
				<li class="dropdown">
					<a data-toggle="dropdown" class="tm-notification" href=""><i class="tmn-counts">9</i></a>
					<div class="dropdown-menu dropdown-menu-lg pull-right">
						<div class="listview" id="notifications">
							<div class="lv-header">
								Notification
				
								<ul class="actions">
									<li class="dropdown">
										<a href="" data-clear="notification">
											<i class="zmdi zmdi-check-all"></i>
										</a>
									</li>
								</ul>
							</div>
							<div class="lv-body">
								<a class="lv-item" href="">
									<div class="media">
										<div class="pull-left">
											<img class="lv-img-sm" src="img/profile-pics/1.jpg" alt="">
										</div>
										<div class="media-body">
											<div class="lv-title">David Belle</div>
											<small class="lv-small">Cum sociis natoque penatibus et magnis dis parturient montes</small>
										</div>
									</div>
								</a>
								<a class="lv-item" href="">
									<div class="media">
										<div class="pull-left">
											<img class="lv-img-sm" src="img/profile-pics/2.jpg" alt="">
										</div>
										<div class="media-body">
											<div class="lv-title">Jonathan Morris</div>
											<small class="lv-small">Nunc quis diam diamurabitur at dolor elementum, dictum turpis vel</small>
										</div>
									</div>
								</a>
								<a class="lv-item" href="">
									<div class="media">
										<div class="pull-left">
											<img class="lv-img-sm" src="img/profile-pics/3.jpg" alt="">
										</div>
										<div class="media-body">
											<div class="lv-title">Fredric Mitchell Jr.</div>
											<small class="lv-small">Phasellus a ante et est ornare accumsan at vel magnauis blandit turpis at augue ultricies</small>
										</div>
									</div>
								</a>
								<a class="lv-item" href="">
									<div class="media">
										<div class="pull-left">
											<img class="lv-img-sm" src="img/profile-pics/4.jpg" alt="">
										</div>
										<div class="media-body">
											<div class="lv-title">Glenn Jecobs</div>
											<small class="lv-small">Ut vitae lacus sem ellentesque maximus, nunc sit amet varius dignissim, dui est consectetur neque</small>
										</div>
									</div>
								</a>
								<a class="lv-item" href="">
									<div class="media">
										<div class="pull-left">
											<img class="lv-img-sm" src="img/profile-pics/4.jpg" alt="">
										</div>
										<div class="media-body">
											<div class="lv-title">Bill Phillips</div>
											<small class="lv-small">Proin laoreet commodo eros id faucibus. Donec ligula quam, imperdiet vel ante placerat</small>
										</div>
									</div>
								</a>
							</div>
				
							<a class="lv-footer" href="">View Previous</a>
						</div>
				
					</div>
				</li>
				<li class="dropdown hidden-xs">
					<a data-toggle="dropdown" class="tm-task" href=""><i class="tmn-counts">2</i></a>
					<div class="dropdown-menu pull-right dropdown-menu-lg">
						<div class="listview">
							<div class="lv-header">
								Tasks
							</div>
							<div class="lv-body">
								<div class="lv-item">
									<div class="lv-title m-b-5">HTML5 Validation Report</div>
				
									<div class="progress">
										<div class="progress-bar" role="progressbar" aria-valuenow="95" aria-valuemin="0" aria-valuemax="100" style="width: 95%">
											<span class="sr-only">95% Complete (success)</span>
										</div>
									</div>
								</div>
								<div class="lv-item">
									<div class="lv-title m-b-5">Google Chrome Extension</div>
				
									<div class="progress">
										<div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="80" aria-valuemin="0" aria-valuemax="100" style="width: 80%">
											<span class="sr-only">80% Complete (success)</span>
										</div>
									</div>
								</div>
								<div class="lv-item">
									<div class="lv-title m-b-5">Social Intranet Projects</div>
				
									<div class="progress">
										<div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100" style="width: 20%">
											<span class="sr-only">20% Complete</span>
										</div>
									</div>
								</div>
								<div class="lv-item">
									<div class="lv-title m-b-5">Bootstrap Admin Template</div>
				
									<div class="progress">
										<div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 60%">
											<span class="sr-only">60% Complete (warning)</span>
										</div>
									</div>
								</div>
								<div class="lv-item">
									<div class="lv-title m-b-5">Youtube Client App</div>
				
									<div class="progress">
										<div class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="80" aria-valuemin="0" aria-valuemax="100" style="width: 80%">
											<span class="sr-only">80% Complete (danger)</span>
										</div>
									</div>
								</div>
							</div>
				
							<a class="lv-footer" href="">View All</a>
						</div>
					</div>
				</li>
				<li class="dropdown">
					<a data-toggle="dropdown" class="tm-settings" href=""></a>
					<ul class="dropdown-menu dm-icon pull-right">
						<li class="hidden-xs">
							<a data-action="fullscreen" href=""><i class="zmdi zmdi-fullscreen"></i> Toggle Fullscreen</a>
						</li>
						<li>
							<a data-action="clear-localstorage" href=""><i class="zmdi zmdi-delete"></i> Clear Local Storage</a>
						</li>
						<li>
							<a href=""><i class="zmdi zmdi-face"></i> Privacy Settings</a>
						</li>
						<li>
							<a href=""><i class="zmdi zmdi-settings"></i> Other Settings</a>
						</li>
					</ul>
				</li>
				<li class="hidden-xs" id="chat-trigger" data-trigger="#chat">
					<a class="tm-chat" href=""></a>
				</li>
			</li>
		</ul>
		
		<!-- Top Search Content -->
		<div id="top-search-wrap">
			<input type="text">
			<i id="top-search-close">&times;</i>
		</div>
	</header>
	
	<section id="main">
		<aside id="sidebar">
			<div class="sidebar-inner c-overflow">
				<div class="profile-menu">
					<a href="">
						<div class="profile-pic">
							<img src="img/profile-pics/1.jpg" alt="">
						</div>

						<div class="profile-info">
							cwell

							<i class="zmdi zmdi-arrow-drop-down"></i>
						</div>
					</a>

					<ul class="main-menu">
						<li>
							<a href="profile-about.html"><i class="zmdi zmdi-account"></i> View Profile</a>
						</li>
						<li>
							<a href=""><i class="zmdi zmdi-input-antenna"></i> Privacy Settings</a>
						</li>
						<li>
							<a href=""><i class="zmdi zmdi-settings"></i> Settings</a>
						</li>
						<li>
							<a href=""><i class="zmdi zmdi-time-restore"></i> Logout</a>
						</li>
					</ul>
				</div>

				<ul class="main-menu" id="menu-public">
				</ul>
			</div>
		</aside>

		
		
		<section id="content">
			<div class="container">
				<div class="block-header">
					<h2></h2>
				</div>

				<div class="card" style="display: none;">
					<div class="card-header">
						<h2>Table CRUD <small>테이블 스키마를 선택해서 데이터를 관리할 수 있습니다.</small></h2>
					</div>

					<div class="card-body card-padding">
						<form class="row" role="form">
							<div class="col-sm-3">
								<div class="form-group fg-line">
									<div class="fg-line select">
										<select class="form-control" id="sel_table_search">
											<option>USER</option>
											<option>Application</option>
											<option>Channel</option>
										</select>
									</div>
								</div>
							</div>

							<div class="col-sm-4">
								<button type="button" id="btn_table_search" class="btn btn-primary btn-sm m-t-5">Search</button>
							</div>
						</form>
					</div>
				</div>

				<div class="card" id="card_input" style="display: none;">
					<form class="form-horizontal" role="form">
						<div class="card-header">
							<h2>데이터 입력</h2>
						</div>
						
						<div class="card-body card-padding">
							<div class="form-group">
								<div class="col-sm-offset-2 col-sm-10">
									<button type="button" class="btn btn-primary btn-sm waves-effect">입력</button>
									<button type="button" class="btn btn-success btn-sm waves-effect">수정</button>
									<button type="button" class="btn btn-warning btn-sm waves-effect">삭제</button>
								</div>
							</div>
						</div>
					</form>
				</div>
				
			</div>
		</section>
	</section>
	
	<footer id="footer">
		Copyright &copy; 2015  Admin
		
		<ul class="f-menu">
			<li><a href="">Home</a></li>
			<li><a href="">Dashboard</a></li>
			<li><a href="">Reports</a></li>
			<li><a href="">Support</a></li>
			<li><a href="">Contact</a></li>
		</ul>
	</footer>

	<!-- Older IE warning message -->
	<!--[if lt IE 9]>
		<div class="ie-warning">
			<h1 class="c-white">Warning!!</h1>
			<p>You are using an outdated version of Internet Explorer, please upgrade <br/>to any of the following web browsers to access this website.</p>
			<div class="iew-container">
				<ul class="iew-download">
					<li>
						<a href="http://www.google.com/chrome/">
							<img src="img/browsers/chrome.png" alt="">
							<div>Chrome</div>
						</a>
					</li>
					<li>
						<a href="https://www.mozilla.org/en-US/firefox/new/">
							<img src="img/browsers/firefox.png" alt="">
							<div>Firefox</div>
						</a>
					</li>
					<li>
						<a href="http://www.opera.com">
							<img src="img/browsers/opera.png" alt="">
							<div>Opera</div>
						</a>
					</li>
					<li>
						<a href="https://www.apple.com/safari/">
							<img src="img/browsers/safari.png" alt="">
							<div>Safari</div>
						</a>
					</li>
					<li>
						<a href="http://windows.microsoft.com/en-us/internet-explorer/download-ie">
							<img src="img/browsers/ie.png" alt="">
							<div>IE (New)</div>
						</a>
					</li>
				</ul>
			</div>
			<p>Sorry for the inconvenience!</p>
		</div>   
	<![endif]-->
	
	



   
</body>
<script>

function onCrud(table, json){
	var $container = $('#content .container');
	var $card = $('<div class="card"><div class="card-header"></div><div class="card-body"><table class="table table-striped table-bordered table-hover table-condensed"><thead></thead><tbody></tbody></table></div></div>');

	// setting table name 
	$card.find('.card-header').html('<h2>'+table+'</h2>');

	// setting table header columns
	var colArr = json.columnNames;
	if(colArr.length > 0) {
		var $thead = $card.find('thead');
		var $tr = $('<tr></tr>');
		for(i=0; i<colArr.length; i++) {
			$tr.append('<th>'+colArr[i]+'</th>');
		}
		$thead.append($tr);

		// 입력폼에 항목 추가
		var input_template = '<div class="form-group"><label class="col-sm-2 control-label" for="input_id_{COLUMN}">{COLUMN}</label><div class="col-sm-10"><div class="fg-line"><input type="text" class="form-control input-sm" id="input_id_{COLUMN}" name="{COLUMN}" placeholder="{COLUMN}"></div></div></div>';
		for(i=colArr.length-1; i>=0; i--) {
			if(colArr[i] == 'seq' || colArr[i] == 'ipt_date')
				continue;
			$('#card_input .card-body').prepend(input_template.replaceAll('{COLUMN}', colArr[i].toUpperCase()));
		}
	}

	// 내용 추가
	var rowArr = json.results;
	if(rowArr.length > 0) {
		var $tbody = $card.find('tbody');
		for(i=0; i<rowArr.length; i++) {
			var $tr = $('<tr></tr>');
			var dataArr = rowArr[i];
			for(j=0; j<dataArr.length; j++) {
				$($tr).append('<td>'+dataArr[j]+'</td>');
			}
			$tbody.append($tr);
		}
	}

	//$container.append($card);
	$('#content .block-header').after( $card );
	$('#card_input').show();
	$('#card_input button').click(function(event){
		var json = getJsonFromFormGroup( $('#card_input') );
		json['table_name'] = g_target_table;
		var str = JSON.stringify(json);
		console.log(str);
		str = Base64.encode(str);
		console.log(str);

		requestInsert(json, function(table, recv) {
			console.log(table + ','+recv);
			//alert(recv.count + '개의 레코드가 입력되었습니다.');
		});
	})
}

$(document).ready(function(){
	var table = getLocationParameter('type');
	initMenu(table);
	
	if(table) {
		requestSelect(table, onCrud);
		return;
	}

	$('#btn_table_search').click(function(event){
		var targetTable = $('#sel_table_search').val();
		requestSelect(targetTable, onCrud);
	});

    $('#content .card').eq(0).show();
});
</script>
</html>

